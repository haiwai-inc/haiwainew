<template>
  <div>
    <div class="container">
      <div>
        <main-menu type="1"></main-menu>
      </div>
      <div class="row">
        <div class="col-sm-8 col-12"> 
          <div
          v-infinite-scroll="loadArticle"
          infinite-scroll-disabled="disabled"
           infinite-scroll-distance="50">
            <article-list-item 
              v-for="item in articlelists"
              v-bind:key="item.id"
              v-bind:data="item"
              type="0">
            </article-list-item>
          </div>
          <div class="text-center py-5" v-if="loading.article"><!-- loader -->
            <i class="now-ui-icons loader_refresh spin"></i>
          </div>
          <p class="text-center py-4" v-if="noMore">没有更多了</p>
        </div>
        <div class="col-sm-4 d-none d-sm-block">
          <div class="hot-bloger" v-if="bloggerList.length>0">
            <bloger-list v-bind:data="bloggerList" :title="$t('message').blog.index_title_hot"></bloger-list>
          </div>
          <!-- help -->
            <div class="box my-3 pl-3 bolger-box">
              <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
              width="28" height="28"
              viewBox="0 0 172 172"
              style=" fill:#000000;"><g transform="translate(4.988,4.988) scale(0.942,0.942)"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="none" stroke-linecap="butt" stroke-linejoin="none" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g id="original-icon 1" fill="#000000" stroke="#cccccc" stroke-width="10" stroke-linejoin="round"><path d="M88.6875,0c33.18433,0 60.33228,26.28711 61.73901,59.125h2.76099c7.41162,0 13.4375,6.02588 13.4375,13.4375v37.625c0,7.40112 -6.02588,13.4375 -13.4375,13.4375v5.375c0,16.29297 -13.25903,29.5625 -29.5625,29.5625h-16.50293c-1.20728,4.61914 -5.375,8.0625 -10.37207,8.0625h-5.375c-5.9314,0 -10.75,-4.8291 -10.75,-10.75c0,-5.9314 4.8186,-10.75 10.75,-10.75h5.375c4.99707,0 9.16479,3.43286 10.37207,8.0625h16.50293c13.34302,0 24.1875,-10.85498 24.1875,-24.1875v-5.375h-3.19141c-1.10229,3.11792 -4.06274,5.375 -7.55859,5.375c-4.45117,0 -8.0625,-3.62183 -8.0625,-8.0625v-59.125c0,-4.45117 3.61133,-8.0625 8.0625,-8.0625c3.49585,0 6.4563,2.24658 7.55859,5.375h0.36743c-0.57739,-12.10425 -4.94458,-23.20068 -11.98877,-32.14502l-12.11474,11.97827c-3.94727,3.89478 -10.09912,4.19922 -14.31934,0.70337c-5.76343,-4.77661 -13.07007,-7.41162 -20.56567,-7.41162c-7.5271,0 -14.85474,2.64551 -20.61816,7.45361c-1.97363,1.6377 -4.36719,2.44604 -6.76074,2.44604c-2.71899,0 -5.44849,-1.0498 -7.5481,-3.10742l-12.16723,-11.94678c-6.9917,8.92334 -11.3169,19.97778 -11.89429,32.02954h0.35693c1.11279,-3.11792 4.07324,-5.375 7.56909,-5.375c4.44067,0 8.0625,3.62183 8.0625,8.0625v59.125c0,4.44067 -3.62183,8.0625 -8.0625,8.0625c-3.49585,0 -6.4563,-2.25708 -7.56909,-5.375h-8.55591c-7.41162,0 -13.4375,-6.02588 -13.4375,-13.4375v-37.625c0,-7.41162 6.02588,-13.4375 13.4375,-13.4375h2.75049c1.41723,-32.83789 28.56518,-59.125 61.74951,-59.125zM42.42261,23.02222l12.41919,12.17773c1.97363,1.94214 5.02857,2.08911 7.09668,0.36743c6.73975,-5.60596 15.28516,-8.69238 24.06152,-8.69238c8.75537,0 17.26929,3.07593 23.98804,8.65039c2.08911,1.71118 5.14404,1.56421 7.11768,-0.38843l12.3667,-12.23022c-10.27759,-10.771 -24.7439,-17.53174 -40.78491,-17.53174h-5.375c-16.09351,0 -30.60181,6.80273 -40.88989,17.64722zM88.6875,13.4375v5.375c0,1.49072 -1.19678,2.6875 -2.6875,2.6875c-1.49072,0 -2.6875,-1.19678 -2.6875,-2.6875v-5.375c0,-1.49072 1.19678,-2.6875 2.6875,-2.6875c1.49072,0 2.6875,1.19678 2.6875,2.6875zM101.65259,12.80762c1.42773,0.38843 2.28857,1.85815 1.90015,3.29639l-1.38574,5.18603c-0.32544,1.20728 -1.41724,1.99463 -2.60352,1.99463c-0.23096,0 -0.46191,-0.03149 -0.70337,-0.08398c-1.42773,-0.38843 -2.27808,-1.86865 -1.90015,-3.29639l1.39624,-5.19653c0.29395,-1.0813 1.19678,-1.82666 2.22559,-1.96313c0.34644,-0.05249 0.71387,-0.03149 1.0708,0.06299zM73.6438,14.71826l1.39624,5.18603c0.37793,1.43823 -0.47241,2.90796 -1.90015,3.29639c-0.24146,0.05249 -0.47241,0.08398 -0.70337,0.08398c-1.19678,0 -2.27808,-0.78735 -2.60352,-1.99463l-1.38574,-5.18603c-0.38843,-1.43823 0.47241,-2.90796 1.90015,-3.29639c0.35693,-0.09448 0.72437,-0.11548 1.0708,-0.06299c1.02881,0.14697 1.93164,0.89233 2.22559,1.97363zM59.42944,19.84131l2.6875,4.64014c0.74536,1.29126 0.31494,2.93945 -0.97632,3.68482c-0.41992,0.24146 -0.88184,0.34643 -1.34375,0.34643c-0.92383,0 -1.82666,-0.47241 -2.32007,-1.34375l-2.6875,-4.64014c-0.74536,-1.29126 -0.31494,-2.92896 0.97632,-3.67432c0.31494,-0.18896 0.66138,-0.30444 1.00781,-0.34643c1.03931,-0.12598 2.11011,0.36743 2.65601,1.33325zM116.23438,18.85449c1.28076,0.74536 1.72168,2.38306 0.97632,3.67432l-2.6875,4.65063c-0.49341,0.86084 -1.39624,1.34375 -2.32007,1.34375c-0.46191,0 -0.92383,-0.11548 -1.34375,-0.35693c-1.29126,-0.74536 -1.72168,-2.39355 -0.97632,-3.67432l2.6875,-4.65063c0.5459,-0.96582 1.6062,-1.45923 2.65601,-1.32276c0.34643,0.04199 0.68237,0.14697 1.00781,0.33594zM32.25,61.8125v59.125c0,1.48022 1.20728,2.6875 2.6875,2.6875c1.48022,0 2.6875,-1.20728 2.6875,-2.6875v-59.125c0,-1.48022 -1.20728,-2.6875 -2.6875,-2.6875c-1.48022,0 -2.6875,1.20728 -2.6875,2.6875zM134.375,61.8125v59.125c0,1.48022 1.20728,2.6875 2.6875,2.6875c1.48022,0 2.6875,-1.20728 2.6875,-2.6875v-59.125c0,-1.48022 -1.20728,-2.6875 -2.6875,-2.6875c-1.48022,0 -2.6875,1.20728 -2.6875,2.6875zM10.75,72.5625v37.625c0,4.44067 3.62183,8.0625 8.0625,8.0625h8.0625v-53.75h-8.0625c-4.44067,0 -8.0625,3.62183 -8.0625,8.0625zM145.125,118.25h8.0625c4.44067,0 8.0625,-3.62183 8.0625,-8.0625v-37.625c0,-4.44067 -3.62183,-8.0625 -8.0625,-8.0625h-8.0625zM86,155.875c0,2.96045 2.41455,5.375 5.375,5.375h5.375c2.96045,0 5.375,-2.41455 5.375,-5.375c0,-2.96045 -2.41455,-5.375 -5.375,-5.375h-5.375c-2.96045,0 -5.375,2.41455 -5.375,5.375z"></path></g><path d="M0,172v-172h172v172z" fill="none" stroke="none" stroke-width="1" stroke-linejoin="miter"></path><g id="original-icon" fill="#000000" stroke="none" stroke-width="1" stroke-linejoin="miter"><path d="M83.3125,0c-33.18433,0 -60.33228,26.28711 -61.74951,59.125h-2.75049c-7.41162,0 -13.4375,6.02588 -13.4375,13.4375v37.625c0,7.41162 6.02588,13.4375 13.4375,13.4375h8.55591c1.11279,3.11792 4.07324,5.375 7.56909,5.375c4.44067,0 8.0625,-3.62183 8.0625,-8.0625v-59.125c0,-4.44067 -3.62183,-8.0625 -8.0625,-8.0625c-3.49585,0 -6.4563,2.25708 -7.56909,5.375h-0.35693c0.57739,-12.05176 4.90259,-23.1062 11.89429,-32.02954l12.16723,11.94678c2.09961,2.05762 4.8291,3.10742 7.5481,3.10742c2.39355,0 4.78711,-0.80835 6.76074,-2.44604c5.76343,-4.80811 13.09107,-7.45361 20.61816,-7.45361c7.49561,0 14.80225,2.63501 20.56567,7.41162c4.22021,3.49585 10.37207,3.19141 14.31934,-0.70337l12.11474,-11.97827c7.04419,8.94434 11.41138,20.04077 11.98877,32.14502h-0.36743c-1.10229,-3.12842 -4.06274,-5.375 -7.55859,-5.375c-4.45117,0 -8.0625,3.61133 -8.0625,8.0625v59.125c0,4.44067 3.61133,8.0625 8.0625,8.0625c3.49585,0 6.4563,-2.25708 7.55859,-5.375h3.19141v5.375c0,13.33252 -10.84448,24.1875 -24.1875,24.1875h-16.50293c-1.20728,-4.62964 -5.375,-8.0625 -10.37207,-8.0625h-5.375c-5.9314,0 -10.75,4.8186 -10.75,10.75c0,5.9209 4.8186,10.75 10.75,10.75h5.375c4.99707,0 9.16479,-3.44336 10.37207,-8.0625h16.50293c16.30347,0 29.5625,-13.26953 29.5625,-29.5625v-5.375c7.41162,0 13.4375,-6.03638 13.4375,-13.4375v-37.625c0,-7.41162 -6.02588,-13.4375 -13.4375,-13.4375h-2.76099c-1.40674,-32.83789 -28.55469,-59.125 -61.73901,-59.125zM83.3125,5.375h5.375c16.04102,0 30.50733,6.76074 40.78491,17.53174l-12.3667,12.23022c-1.97363,1.95264 -5.02857,2.09961 -7.11768,0.38843c-6.71875,-5.57446 -15.23266,-8.65039 -23.98804,-8.65039c-8.77637,0 -17.32178,3.08643 -24.06152,8.69238c-2.06811,1.72168 -5.12305,1.57471 -7.09668,-0.36743l-12.41919,-12.17773c10.28809,-10.84448 24.79639,-17.64722 40.88989,-17.64722zM86,10.75c-1.49072,0 -2.6875,1.19678 -2.6875,2.6875v5.375c0,1.49072 1.19678,2.6875 2.6875,2.6875c1.49072,0 2.6875,-1.19678 2.6875,-2.6875v-5.375c0,-1.49072 -1.19678,-2.6875 -2.6875,-2.6875zM100.58179,12.74463c-1.02881,0.13647 -1.93164,0.88184 -2.22559,1.96313l-1.39624,5.19653c-0.37793,1.42773 0.47241,2.90796 1.90015,3.29639c0.24146,0.05249 0.47241,0.08398 0.70337,0.08398c1.18628,0 2.27808,-0.78735 2.60352,-1.99463l1.38574,-5.18603c0.38843,-1.43823 -0.47241,-2.90796 -1.90015,-3.29639c-0.35693,-0.09448 -0.72436,-0.11548 -1.0708,-0.06299zM71.41821,12.74463c-0.34643,-0.05249 -0.71387,-0.03149 -1.0708,0.06299c-1.42773,0.38843 -2.28857,1.85815 -1.90015,3.29639l1.38574,5.18603c0.32544,1.20728 1.40674,1.99463 2.60352,1.99463c0.23096,0 0.46191,-0.03149 0.70337,-0.08398c1.42773,-0.38843 2.27808,-1.85816 1.90015,-3.29639l-1.39624,-5.18603c-0.29395,-1.0813 -1.19678,-1.82666 -2.22559,-1.97363zM56.77344,18.50806c-0.34643,0.04199 -0.69287,0.15747 -1.00781,0.34643c-1.29126,0.74536 -1.72168,2.38306 -0.97632,3.67432l2.6875,4.64014c0.49341,0.87134 1.39624,1.34375 2.32007,1.34375c0.46191,0 0.92383,-0.10498 1.34375,-0.34643c1.29126,-0.74536 1.72168,-2.39355 0.97632,-3.68482l-2.6875,-4.64014c-0.5459,-0.96582 -1.6167,-1.45923 -2.65601,-1.33325zM115.22656,18.51855c-1.0498,-0.13647 -2.11011,0.35693 -2.65601,1.32276l-2.6875,4.65063c-0.74536,1.28076 -0.31494,2.92896 0.97632,3.67432c0.41992,0.24146 0.88184,0.35693 1.34375,0.35693c0.92383,0 1.82666,-0.48291 2.32007,-1.34375l2.6875,-4.65063c0.74536,-1.29126 0.30445,-2.92896 -0.97632,-3.67432c-0.32544,-0.18896 -0.66138,-0.29395 -1.00781,-0.33594zM34.9375,59.125c1.48022,0 2.6875,1.20728 2.6875,2.6875v59.125c0,1.48022 -1.20728,2.6875 -2.6875,2.6875c-1.48022,0 -2.6875,-1.20728 -2.6875,-2.6875v-59.125c0,-1.48022 1.20728,-2.6875 2.6875,-2.6875zM137.0625,59.125c1.48022,0 2.6875,1.20728 2.6875,2.6875v59.125c0,1.48022 -1.20728,2.6875 -2.6875,2.6875c-1.48022,0 -2.6875,-1.20728 -2.6875,-2.6875v-59.125c0,-1.48022 1.20728,-2.6875 2.6875,-2.6875zM18.8125,64.5h8.0625v53.75h-8.0625c-4.44067,0 -8.0625,-3.62183 -8.0625,-8.0625v-37.625c0,-4.44067 3.62183,-8.0625 8.0625,-8.0625zM145.125,64.5h8.0625c4.44067,0 8.0625,3.62183 8.0625,8.0625v37.625c0,4.44067 -3.62183,8.0625 -8.0625,8.0625h-8.0625zM91.375,150.5h5.375c2.96045,0 5.375,2.41455 5.375,5.375c0,2.96045 -2.41455,5.375 -5.375,5.375h-5.375c-2.96045,0 -5.375,-2.41455 -5.375,-5.375c0,-2.96045 2.41455,-5.375 5.375,-5.375z"></path></g><path d="" fill="none" stroke="none" stroke-width="1" stroke-linejoin="miter"></path><path d="" fill="none" stroke="none" stroke-width="1" stroke-linejoin="miter"></path></g></g></svg>
                <span class="ml-3 mb-3 h6">帮助中心</span>
                <div class=row>
                  <div class="col-6 mt-3 text-secondary">如何上传图片</div>
                  <div class="col-6 mt-3  text-secondary">怎样发视频</div>
                  <div class="col-12 mt-3 text-secondary">如何贴音乐</div>
                </div>
            </div>
            <!-- help -->
        </div>
        


      </div>
    </div>
  </div>
</template>
<script>
import MainMenu from './components/Main/MainMenu.vue';
import ArticleListItem from './components/Main/ArticleListItem.vue';
import BlogerList from './components/Main/BlogerList.vue';
import blog from '../blog.service';

export default {
  name: 'blog-index',
  components: {
    MainMenu,
    ArticleListItem,
    BlogerList,
  },
  computed:{
    disabled () {
      return this.loading.article || this.noMore
    }
  },
  methods:{
    loadArticle(){
      this.loading.article=true;
      blog.recommend_article(this.lastID.article).then(res=>{
        if(res.status){
          let arr = res.data;
          this.noMore = arr.length<30 ? true : false;
          this.lastID.article = arr.length===30 ? arr[arr.length-1].postID : this.lastID.article;
          this.articlelists = this.articlelists.concat(arr) ;
          this.loading.article=false;
          console.log(arr,this.lastID,this.noMore);
        }
      })
    },
  },
  created () {
    blog.hot_blogger().then(res=>{
      if(res.status){
        this.res_bloggerList=res.data;
        this.bloggerList=this.res_bloggerList;
        this.loading.blogger=false;
      }
    });
    this.loadArticle();
  },
  data() {
    return {
      noMore:false,
      lastID:{article:0,blogger:0},
      loading:{article:true,blogger:true},
      res_bloggerList:[],
      bloggerList : [],
      articlelists: [],
    };
  },
};
</script>
<style></style>
